[{"path":"https://hohoweiya.xyz/MTWAS/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2023 MTWAS authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://hohoweiya.xyz/MTWAS/articles/mtwas.html","id":"step-0-data-preparation","dir":"Articles","previous_headings":"","what":"Step 0: Data Preparation","title":"MTWAS","text":"Load demo TWAS data, consists 3 genes 5 tissues (cell types).","code":"data(\"twas_data\") str(twas_data) #> List of 4 #>  $ E     :List of 5 #>   ..$ : num [1:715, 1:3] -0.0744 -0.0187 -0.0881 -0.0381 -0.0197 ... #>   .. ..- attr(*, \"dimnames\")=List of 2 #>   .. .. ..$ : NULL #>   .. .. ..$ : chr [1:3] \"E0\" \"\" \"\" #>   ..$ : num [1:715, 1:3] -0.05206 -0.02378 -0.01437 -0.04873 -0.00659 ... #>   .. ..- attr(*, \"dimnames\")=List of 2 #>   .. .. ..$ : NULL #>   .. .. ..$ : chr [1:3] \"E0\" \"\" \"\" #>   ..$ : num [1:715, 1:3] -0.15363 -0.0181 0.00329 -0.00135 0.13717 ... #>   .. ..- attr(*, \"dimnames\")=List of 2 #>   .. .. ..$ : NULL #>   .. .. ..$ : chr [1:3] \"E0\" \"\" \"\" #>   ..$ : num [1:715, 1:3] -0.05677 0.02944 0.00605 -0.12619 -0.19318 ... #>   .. ..- attr(*, \"dimnames\")=List of 2 #>   .. .. ..$ : NULL #>   .. .. ..$ : chr [1:3] \"E0\" \"\" \"\" #>   ..$ : num [1:715, 1:3] 0.00259 -0.03566 0.01043 0.01939 0.03691 ... #>   .. ..- attr(*, \"dimnames\")=List of 2 #>   .. .. ..$ : NULL #>   .. .. ..$ : chr [1:3] \"E0\" \"\" \"\" #>  $ dat   :List of 2 #>   ..$ bed: int [1:715, 1:509] 0 0 0 0 0 0 0 0 1 0 ... #>   .. ..- attr(*, \"dimnames\")=List of 2 #>   .. .. ..$ : NULL #>   .. .. ..$ : chr [1:509] \"chr22_16390411_G_A_b38_A\" \"chr22_16396408_C_G_b38_G\" \"chr22_16406147_A_G_b38_G\" \"chr22_16412132_G_A_b38_A\" ... #>   ..$ bim:Classes 'data.table' and 'data.frame': 509 obs. of  6 variables: #>   .. ..$ V1: int [1:509] 22 22 22 22 22 22 22 22 22 22 ... #>   .. ..$ V2: chr [1:509] \"rs131538\" \"rs140378\" \"rs7287144\" \"rs5748662\" ... #>   .. ..$ V3: int [1:509] 0 0 0 0 0 0 0 0 0 0 ... #>   .. ..$ V4: int [1:509] 16390411 16396408 16406147 16412132 16437595 16461056 16472237 16551808 16573830 16577726 ... #>   .. ..$ V5: chr [1:509] \"A\" \"G\" \"G\" \"A\" ... #>   .. ..$ V6: chr [1:509] \"G\" \"C\" \"A\" \"G\" ... #>   .. ..- attr(*, \".internal.selfref\")=<externalptr>  #>  $ E.info:Classes 'data.table' and 'data.frame': 3 obs. of  4 variables: #>   ..$ chr  : int [1:3] 22 22 22 #>   ..$ start: int [1:3] 15528192 15690026 16590751 #>   ..$ end  : int [1:3] 15529139 15721631 16592810 #>   ..$ gene : chr [1:3] \"OR11H1\" \"POTEH\" \"CCT8L2\" #>   ..- attr(*, \".internal.selfref\")=<externalptr>  #>  $ pos   :List of 3 #>   ..$ : int [1:7] 1 2 3 4 5 6 7 #>   ..$ : int [1:37] 1 2 3 4 5 6 7 8 9 10 ... #>   ..$ : int [1:509] 1 2 3 4 5 6 7 8 9 10 ..."},{"path":"https://hohoweiya.xyz/MTWAS/articles/mtwas.html","id":"step-1-train-weights","dir":"Articles","previous_headings":"","what":"Step 1: Train Weights","title":"MTWAS","text":"Firstly, detect cross-tissue eQTLs, One can specify ncores parallel computing. fix ct.eQTLs, select tissue-specific eQTLs, default, returns list ts-eQTLs tissue. can also specify index tissue get corresponding ts-eQTL,","code":"ct.eQTL = select.ct.eQTL(twas_data, verbose = F, ncores = 1) ct.eQTL #> $OR11H1 #> numeric(0) #>  #> $POTEH #> numeric(0) #>  #> $CCT8L2 #> numeric(0) list.ts.eQTL = select.ts.eQTL(twas_data, ct.eQTL = ct.eQTL, ncores = 1) list.ts.eQTL #> [[1]] #> [[1]]$OR11H1 #> [[1]]$OR11H1$BIC #> [1] -677.0032 #>  #> [[1]]$OR11H1$best_term #> [1] 5 #>  #> [[1]]$OR11H1$coef #> (Intercept)        term  #> -0.01445075  0.01531436  #>  #> [[1]]$OR11H1$single #> [1] 5 #>  #> [[1]]$OR11H1$single.snp #> [1] \"rs2027653\" #>  #> [[1]]$OR11H1$common.snp #> character(0) #>  #>  #> [[1]]$POTEH #> [[1]]$POTEH$BIC #> [1] 737.335 #>  #> [[1]]$POTEH$best_term #> [1] 36 #>  #> [[1]]$POTEH$coef #>  (Intercept)         term  #> -0.009329623  0.027192333  #>  #> [[1]]$POTEH$single #> [1] 36 #>  #> [[1]]$POTEH$single.snp #> [1] \"rs5746879\" #>  #> [[1]]$POTEH$common.snp #> character(0) #>  #>  #> [[1]]$CCT8L2 #> [[1]]$CCT8L2$BIC #> [1] 1312.692 #>  #> [[1]]$CCT8L2$best_term #> [1] 498 #>  #> [[1]]$CCT8L2$coef #> (Intercept)        term  #>  0.12004208 -0.08698112  #>  #> [[1]]$CCT8L2$single #> [1] 498 #>  #> [[1]]$CCT8L2$single.snp #> [1] \"rs174345\" #>  #> [[1]]$CCT8L2$common.snp #> character(0) #>  #>  #>  #> [[2]] #> [[2]]$OR11H1 #> [[2]]$OR11H1$BIC #> [1] -64.34403 #>  #> [[2]]$OR11H1$best_term #> [1] 6 #>  #> [[2]]$OR11H1$coef #> (Intercept)        term  #>  0.02199233 -0.03487156  #>  #> [[2]]$OR11H1$single #> [1] 6 #>  #> [[2]]$OR11H1$single.snp #> [1] \"rs4384884\" #>  #> [[2]]$OR11H1$common.snp #> character(0) #>  #>  #> [[2]]$POTEH #> [[2]]$POTEH$BIC #> [1] 451.0904 #>  #> [[2]]$POTEH$best_term #> [1] 29 #>  #> [[2]]$POTEH$coef #> (Intercept)        term  #>  0.06072520 -0.04569124  #>  #> [[2]]$POTEH$single #> [1] 29 #>  #> [[2]]$POTEH$single.snp #> [1] \"rs2845371\" #>  #> [[2]]$POTEH$common.snp #> character(0) #>  #>  #> [[2]]$CCT8L2 #> [[2]]$CCT8L2$BIC #> [1] 1117.912 #>  #> [[2]]$CCT8L2$best_term #> [1] 268 #>  #> [[2]]$CCT8L2$coef #> (Intercept)        term  #> -0.02949304  0.07353065  #>  #> [[2]]$CCT8L2$single #> [1] 268 #>  #> [[2]]$CCT8L2$single.snp #> [1] \"rs5994176\" #>  #> [[2]]$CCT8L2$common.snp #> character(0) #>  #>  #>  #> [[3]] #> [[3]]$OR11H1 #> [[3]]$OR11H1$BIC #> [1] -552.0486 #>  #> [[3]]$OR11H1$best_term #> [1] 3 #>  #> [[3]]$OR11H1$coef #>  (Intercept)         term  #>  0.010976617 -0.004856457  #>  #> [[3]]$OR11H1$single #> [1] 3 #>  #> [[3]]$OR11H1$single.snp #> [1] \"rs7287144\" #>  #> [[3]]$OR11H1$common.snp #> character(0) #>  #>  #> [[3]]$POTEH #> [[3]]$POTEH$BIC #> [1] 570.0594 #>  #> [[3]]$POTEH$best_term #> [1] 32 #>  #> [[3]]$POTEH$coef #> (Intercept)        term  #> -0.01171048 -0.05688065  #>  #> [[3]]$POTEH$single #> [1] 32 #>  #> [[3]]$POTEH$single.snp #> [1] \"rs2845377\" #>  #> [[3]]$POTEH$common.snp #> character(0) #>  #>  #> [[3]]$CCT8L2 #> [[3]]$CCT8L2$BIC #> [1] 892.6655 #>  #> [[3]]$CCT8L2$best_term #> [1] 392 #>  #> [[3]]$CCT8L2$coef #> (Intercept)        term  #> -0.02638992  0.07828622  #>  #> [[3]]$CCT8L2$single #> [1] 392 #>  #> [[3]]$CCT8L2$single.snp #> [1] \"rs5747087\" #>  #> [[3]]$CCT8L2$common.snp #> character(0) #>  #>  #>  #> [[4]] #> [[4]]$OR11H1 #> [[4]]$OR11H1$BIC #> [1] -105.8922 #>  #> [[4]]$OR11H1$best_term #> [1] 7 #>  #> [[4]]$OR11H1$coef #>   (Intercept)          term  #> -2.022243e-06  1.071937e-02  #>  #> [[4]]$OR11H1$single #> [1] 7 #>  #> [[4]]$OR11H1$single.snp #> [1] NA #>  #> [[4]]$OR11H1$common.snp #> character(0) #>  #>  #> [[4]]$POTEH #> [[4]]$POTEH$BIC #> [1] 594.8341 #>  #> [[4]]$POTEH$best_term #> [1] 22 #>  #> [[4]]$POTEH$coef #> (Intercept)        term  #>  0.01896703 -0.04184011  #>  #> [[4]]$POTEH$single #> [1] 22 #>  #> [[4]]$POTEH$single.snp #> [1] \"rs5993671\" #>  #> [[4]]$POTEH$common.snp #> character(0) #>  #>  #> [[4]]$CCT8L2 #> [[4]]$CCT8L2$BIC #> [1] 1266.084 #>  #> [[4]]$CCT8L2$best_term #> [1] 79 #>  #> [[4]]$CCT8L2$coef #> (Intercept)        term  #> -0.02550013  0.13037882  #>  #> [[4]]$CCT8L2$single #> [1] 79 #>  #> [[4]]$CCT8L2$single.snp #> [1] \"rs2072466\" #>  #> [[4]]$CCT8L2$common.snp #> character(0) #>  #>  #>  #> [[5]] #> [[5]]$OR11H1 #> [[5]]$OR11H1$BIC #> [1] -102.3713 #>  #> [[5]]$OR11H1$best_term #> [1] 2 #>  #> [[5]]$OR11H1$coef #> (Intercept)        term  #> 0.002950217 0.039894448  #>  #> [[5]]$OR11H1$single #> [1] 2 #>  #> [[5]]$OR11H1$single.snp #> [1] \"rs140378\" #>  #> [[5]]$OR11H1$common.snp #> character(0) #>  #>  #> [[5]]$POTEH #> [[5]]$POTEH$BIC #> [1] 97.10953 #>  #> [[5]]$POTEH$best_term #> [1] 27 #>  #> [[5]]$POTEH$coef #> (Intercept)        term  #>  0.03624239 -0.03725128  #>  #> [[5]]$POTEH$single #> [1] 27 #>  #> [[5]]$POTEH$single.snp #> [1] \"rs361973\" #>  #> [[5]]$POTEH$common.snp #> character(0) #>  #>  #> [[5]]$CCT8L2 #> [[5]]$CCT8L2$BIC #> [1] 865.5521 #>  #> [[5]]$CCT8L2$best_term #> [1] 353 #>  #> [[5]]$CCT8L2$coef #> (Intercept)        term  #>  -0.0392554   0.0883380  #>  #> [[5]]$CCT8L2$single #> [1] 353 #>  #> [[5]]$CCT8L2$single.snp #> [1] \"rs5994253\" #>  #> [[5]]$CCT8L2$common.snp #> character(0) select.ts.eQTL(twas_data, ct.eQTL = ct.eQTL, ncores = 1, id.tissue = 1)"},{"path":"https://hohoweiya.xyz/MTWAS/articles/mtwas.html","id":"step-2-association-test","dir":"Articles","previous_headings":"","what":"Step 2: Association Test","title":"MTWAS","text":"Load GWAS summary statistics phenotype perform association test tissue-specific manner retain tissue specificity trait-gene associations. Alternatively, one can pass file name summary statistics, multiple traits, one can pass list summary statistics files, e.g.,","code":"data(\"summary_stats\") str(summary_stats) #> 'data.frame':    1000 obs. of  5 variables: #>  $ rsid: chr  \"rs7287144\" \"rs5748662\" \"rs4010554\" \"rs4010558\" ... #>  $ ref : chr  \"G\" \"A\" \"A\" \"A\" ... #>  $ alt : chr  \"A\" \"G\" \"C\" \"G\" ... #>  $ chr : int  22 22 22 22 22 22 22 22 22 22 ... #>  $ z   : num  0.584 0.638 0.857 0.835 0.29 ... twas.single.trait(summary_stats, twas_data, list.ts.eQTL) #> $zstat #>           tissue1   tissue2   tissue3    tissue4   tissue5 #> OR11H1  0.7725160 -0.157939 -0.204543 -0.0847286  1.105520 #> POTEH  -1.4419600  0.000000  0.321247  0.0000000 -1.903690 #> CCT8L2  0.0468013  1.106580  2.510330 -0.7973990 -0.929517 #>  #> $pval #>          tissue1   tissue2    tissue3   tissue4    tissue5 #> OR11H1 0.4398089 0.8745049 0.83792919 0.9324772 0.26893433 #> POTEH  0.1493137 1.0000000 0.74802322 1.0000000 0.05695057 #> CCT8L2 0.9626716 0.2684756 0.01206184 0.4252193 0.35262122 twas.single.trait(twas_data, \"/tmp/gwas_summary_stats.txt\", list.ts.eQTL) twas.multiple.trait(twas_data, paste0(\"/tmp/trait\", 1:10, \"_gwas_summary_stats.txt\"), list.ts.eQTL)"},{"path":"https://hohoweiya.xyz/MTWAS/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Lijun Wang. Author, maintainer. Shuang Song. Author.","code":""},{"path":"https://hohoweiya.xyz/MTWAS/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Wang L, Song S (2024). MTWAS: Multi-tissue Transcriptome-Wide Association Studies. R package version 0.1.0, https://github.com/szcf-weiya/MTWAS.","code":"@Manual{,   title = {MTWAS: Multi-tissue Transcriptome-Wide Association Studies},   author = {Lijun Wang and Shuang Song},   year = {2024},   note = {R package version 0.1.0},   url = {https://github.com/szcf-weiya/MTWAS}, }"},{"path":"https://hohoweiya.xyz/MTWAS/index.html","id":"mtwas-multi-tissue-transcriptome-wide-association-studies","dir":"","previous_headings":"","what":"Multi-tissue Transcriptome-Wide Association Studies","title":"Multi-tissue Transcriptome-Wide Association Studies","text":"MTWAS R package paper Song, S., Wang, L., Hou, L., & Liu, J. S. (2024). Partitioning aggregating cross-tissue tissue-specific genetic effects identifying gene-trait associations. 💡 provide pre-trained eQTL weights MTWAS 47 GTEx version 8 tissues, 13 types immune cells 2 activation conditions DICE dataset, 14 immune cell types single-cell RNA-seq OneK1K dataset. 😃 either run MTWAS pre-trained weights (⭐easy recommended), train models expression data!","code":""},{"path":"https://hohoweiya.xyz/MTWAS/index.html","id":"table-of-contents","dir":"","previous_headings":"","what":"Table of contents","title":"Multi-tissue Transcriptome-Wide Association Studies","text":"Prerequisites Installation Prepare GWAS summary statistics Run MTWAS pre-trained GTEx v8 weights Run MTWAS pre-trained DICE weights Run MTWAS pre-trained OneK1K weights Train MTWAS datasets","code":""},{"path":"https://hohoweiya.xyz/MTWAS/index.html","id":"white_check_mark-prerequisites","dir":"","previous_headings":"","what":"✅ Prerequisites","title":"Multi-tissue Transcriptome-Wide Association Studies","text":"software developed tested Linux Windows environments. R (>=3.6) GNU Scientific Library (GSL) (>=2.3)","code":""},{"path":"https://hohoweiya.xyz/MTWAS/index.html","id":"hammer_and_wrench-installation","dir":"","previous_headings":"","what":"🛠️ Installation","title":"Multi-tissue Transcriptome-Wide Association Studies","text":"","code":"devtools::install_github(\"szcf-weiya/MTWAS\")"},{"path":"https://hohoweiya.xyz/MTWAS/index.html","id":"scroll-prepare-gwas-summary-statistics","dir":"","previous_headings":"","what":"📜 Prepare GWAS summary statistics","title":"Multi-tissue Transcriptome-Wide Association Studies","text":"Please prepare GWAS summary statistics following format (including header line): chr: chromosome rsid: SNP rsid ref: reference allele alt: alternative allele z: GWAS z score","code":"chr        rsid     ref   alt       z              1      rs4040617    G     A     -0.199         1      rs4075116    C     T      0.646          1      rs9442385    T     G     -0.016         ..."},{"path":[]},{"path":"https://hohoweiya.xyz/MTWAS/index.html","id":"download-the-pre-trained-files","dir":"","previous_headings":"🚀 Run MTWAS with pre-trained GTEx v8 weights","what":"Download the pre-trained files:","title":"Multi-tissue Transcriptome-Wide Association Studies","text":"","code":"wget -O gtex_v8_mtwas_eqtls.tar.gz https://cloud.tsinghua.edu.cn/f/5633911d7c39431b8be8/?dl=1 --no-check-certificate tar -zxvf gtex_v8_mtwas_eqtls.tar.gz"},{"path":"https://hohoweiya.xyz/MTWAS/index.html","id":"mtwas-analysis","dir":"","previous_headings":"🚀 Run MTWAS with pre-trained GTEx v8 weights","what":"MTWAS analysis:","title":"Multi-tissue Transcriptome-Wide Association Studies","text":"use chromosome 22 whole blood example. list cell types detailed ct_use.RData. output results data.frame following format: gene: gene name MTWAS_Z: gene-trait association Z score derived MTWAS MTWAS_P: gene-trait association P value derived MTWAS pred_r2: prediction accuracy gene expression evaluated r2 pred_pv: prediction accuracy gene expression evaluated F-test Note output results genes. Users specify thresholds outputs, e.g.,results[results$pred_pv < 0.05 & results$MTWAS_P < 5e-6, ].","code":"library(MTWAS) data(\"summary_stats\") ## EXAMPLE GWAS summary stats (could be specified by users, format: a data.frame with colnames: chr, rsid, a1, a2, z) chr = 22 cell_type = 'Whole_Blood' ### remember to change the path to the downloaded folder!!! ## load twas bim files (downloaded) load(paste0('./gtex_v8_mtwas_eqtls/twas_bim_chr', chr, '.RData'))   ## load twas eqtl files (downloaded) load(paste0('./gtex_v8_mtwas_eqtls/', cell_type, '/twas_eqtl_chr', chr, '.RData')) ## Run mtwas and derive the gene-trait association test statistics results = run_mtwas_easy(summary_stats, twas_bim, twas_eqtl, pred_res)  head(results) gene        MTWAS_Z      MTWAS_P     pred_r2      pred_pv            PLA2G3        -1.87        0.062        0.01        0.02       PANX2         -1.83        0.066        0.01        0.08          ..."},{"path":[]},{"path":[]},{"path":"https://hohoweiya.xyz/MTWAS/index.html","id":"key-train-your-own-weights","dir":"","previous_headings":"","what":"🔑 Train your own weights","title":"Multi-tissue Transcriptome-Wide Association Studies","text":"also provide functions train MTWAS datasets!","code":""},{"path":"https://hohoweiya.xyz/MTWAS/index.html","id":"step-1-data-preparation","dir":"","previous_headings":"🔑 Train your own weights","what":"Step 1: Data preparation","title":"Multi-tissue Transcriptome-Wide Association Studies","text":"order derive MTWAS weights, three types data necessary. demo dataset built R package:","code":"library(MTWAS) data('demo') # demo$dat # demo$E.info # demo$E"},{"path":"https://hohoweiya.xyz/MTWAS/index.html","id":"id_1-genotype-files-dat","dir":"","previous_headings":"🔑 Train your own weights > Step 1: Data preparation","what":"(1) Genotype files (dat)","title":"Multi-tissue Transcriptome-Wide Association Studies","text":"Format: list plink bfiles, including bim, fam, bed One use R function read_plink package EBPRS read plink files:","code":"library(EBPRS) dat <- read_plink('PATH_TO_PLINK_BFILE')"},{"path":"https://hohoweiya.xyz/MTWAS/index.html","id":"id_2-gene-information-einfo","dir":"","previous_headings":"🔑 Train your own weights > Step 1: Data preparation","what":"(2) Gene information (E.info)","title":"Multi-tissue Transcriptome-Wide Association Studies","text":"Genes interested derive gene-trait associations. Format: data.frame following format (including header line):","code":"chr        start        end        gene              22      15528192    15529139     OR11H1        22      15690026    15721631     POTEH               ..."},{"path":"https://hohoweiya.xyz/MTWAS/index.html","id":"id_3-gene-expression-data-e","dir":"","previous_headings":"🔑 Train your own weights > Step 1: Data preparation","what":"(3) Gene expression data (E)","title":"Multi-tissue Transcriptome-Wide Association Studies","text":"list including gene expression data, length list number tissues. element sample*gene matrix. matrix rownames (overlapped dat$fam$V2), colnames (overlapped E.info$gene) orders columns rows matrices necessary . matrices can NAs. ❗ Please NOTE position dat$bim$V4 E.info build (e.g., hg19, hg38, etc.)","code":""},{"path":"https://hohoweiya.xyz/MTWAS/index.html","id":"step-2-data-imputation-and-formatting","dir":"","previous_headings":"🔑 Train your own weights","what":"Step 2: Data imputation and formatting","title":"Multi-tissue Transcriptome-Wide Association Studies","text":"","code":"library(MTWAS) data('demo') ### substitute the input with your own dataset twas_dat <- format_twas_dat(E=demo$E, E.info=demo$E.info, dat=demo$dat)  names(twas_dat)"},{"path":"https://hohoweiya.xyz/MTWAS/index.html","id":"step-3-model-training","dir":"","previous_headings":"🔑 Train your own weights","what":"Step 3: Model training","title":"Multi-tissue Transcriptome-Wide Association Studies","text":"","code":"# load TWAS data # select cross-tissue eQTLs ct.eQTL = select.ct.eQTL(twas_dat, verbose = F, ncores = 1) # select tissue-specific eQTLs list.eQTL = select.ts.eQTL(twas_dat, ct.eQTL = ct.eQTL, ncores = 1)"},{"path":"https://hohoweiya.xyz/MTWAS/index.html","id":"step-4-extract-cross-tissue-eqtls","dir":"","previous_headings":"🔑 Train your own weights","what":"Step 4: Extract cross-tissue eQTLs","title":"Multi-tissue Transcriptome-Wide Association Studies","text":"","code":"gene_name = 'IL17RA' ## gene name gene_index = which(names(ct.eQTL)==gene_name) ## ct-eQTLs for gene IL17RA print(list.eQTL[[1]][[gene_index]]$`common.snp`)"},{"path":"https://hohoweiya.xyz/MTWAS/index.html","id":"step-5-extract-tissue-specific-eqtls","dir":"","previous_headings":"🔑 Train your own weights","what":"Step 5: Extract tissue-specific eQTLs","title":"Multi-tissue Transcriptome-Wide Association Studies","text":"","code":"gene_name = 'CCT8L2' ## gene name gene_index = which(names(ct.eQTL)==gene_name) tissue_index = 1 ## tissue specific ## ts-eQTLs for gene CCT8L2 on tissue 1 print(list.eQTL[[tissue_index]][[gene_index]]$`single.snp`)"},{"path":"https://hohoweiya.xyz/MTWAS/index.html","id":"step-6-gene-trait-association-tests","dir":"","previous_headings":"🔑 Train your own weights","what":"Step 6: Gene-trait association tests","title":"Multi-tissue Transcriptome-Wide Association Studies","text":"details output data formats can found auto-generated vignette: https://hohoweiya.xyz/MTWAS/articles/mtwas.html","code":"# load GWAS summary statistics (data.frame, colnames: rsid, a1, a2, chr, z) data(\"summary_stats\") # association test twas.single.trait(summary_stats, twas_dat, list.eQTL)"},{"path":"https://hohoweiya.xyz/MTWAS/index.html","id":"references","dir":"","previous_headings":"","what":"References","title":"Multi-tissue Transcriptome-Wide Association Studies","text":"MTWAS software > Song, S., Wang, L., Hou, L., & Liu, J. S. (2024). Partitioning aggregating cross-tissue tissue-specific genetic effects identifying gene-trait associations. GTEx dataset > https://gtexportal.org/home/ DICE dataset > https://dice-database.org/ Schmiedel, Benjamin J., et al. “Impact genetic polymorphisms human immune cell gene expression.” Cell 175.6 (2018): 1701-1715. OneK1K dataset > https://onek1k.org/ Yazar, Seyhan, et al. “Single-cell eQTL mapping identifies cell type–specific genetic control autoimmune disease.” Science 376.6589 (2022): eabf3041.","code":""},{"path":"https://hohoweiya.xyz/MTWAS/reference/create_pmatrix_from_terms.html","id":null,"dir":"Reference","previous_headings":"","what":"Create matrix from select terms — create_pmatrix_from_terms","title":"Create matrix from select terms — create_pmatrix_from_terms","text":"Create matrix select terms","code":""},{"path":"https://hohoweiya.xyz/MTWAS/reference/create_pmatrix_from_terms.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create matrix from select terms — create_pmatrix_from_terms","text":"","code":"create_pmatrix_from_terms(xx, terms)"},{"path":"https://hohoweiya.xyz/MTWAS/reference/create_pmatrix_from_terms.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create matrix from select terms — create_pmatrix_from_terms","text":"xx raw matrix colnames natural indexes terms selected terms. exist interact terms like *j, -th column multiply j-th column, result new column.","code":""},{"path":"https://hohoweiya.xyz/MTWAS/reference/create_pmatrix_from_terms.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create matrix from select terms — create_pmatrix_from_terms","text":"matrix","code":""},{"path":"https://hohoweiya.xyz/MTWAS/reference/demo.html","id":null,"dir":"Reference","previous_headings":"","what":"Demo original dataset — demo","title":"Demo original dataset — demo","text":"Demo original dataset","code":""},{"path":"https://hohoweiya.xyz/MTWAS/reference/demo.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Demo original dataset — demo","text":"","code":"demo"},{"path":"https://hohoweiya.xyz/MTWAS/reference/demo.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Demo original dataset — demo","text":"## `demo`","code":""},{"path":"https://hohoweiya.xyz/MTWAS/reference/find.index.html","id":null,"dir":"Reference","previous_headings":"","what":"match index — find.index","title":"match index — find.index","text":"match index","code":""},{"path":"https://hohoweiya.xyz/MTWAS/reference/find.index.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"match index — find.index","text":"","code":"find.index(df1, df2, type = \"reg\")"},{"path":"https://hohoweiya.xyz/MTWAS/reference/find.index.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"match index — find.index","text":"df1 data.frame 1 df2 data.frame 2 type type","code":""},{"path":"https://hohoweiya.xyz/MTWAS/reference/find.index.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"match index — find.index","text":"matched index","code":""},{"path":"https://hohoweiya.xyz/MTWAS/reference/format_twas_dat.html","id":null,"dir":"Reference","previous_headings":"","what":"Data preparation — format_twas_dat","title":"Data preparation — format_twas_dat","text":"Data preparation","code":""},{"path":"https://hohoweiya.xyz/MTWAS/reference/format_twas_dat.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Data preparation — format_twas_dat","text":"","code":"format_twas_dat(dat, E, E.info)"},{"path":"https://hohoweiya.xyz/MTWAS/reference/format_twas_dat.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Data preparation — format_twas_dat","text":"dat plink bfile E original gene expression matrix (list), length list number tissues,  element sample*gene matrix, rownames sample id, colnames gene id E.info data.frame columns: chr, start, end, pos","code":""},{"path":"https://hohoweiya.xyz/MTWAS/reference/format_twas_dat.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Data preparation — format_twas_dat","text":"standard mtwas data format","code":""},{"path":"https://hohoweiya.xyz/MTWAS/reference/impute.E.html","id":null,"dir":"Reference","previous_headings":"","what":"Impute the list of expression matrix `E` — impute.E","title":"Impute the list of expression matrix `E` — impute.E","text":"Impute list expression matrix `E`","code":""},{"path":"https://hohoweiya.xyz/MTWAS/reference/impute.E.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Impute the list of expression matrix `E` — impute.E","text":"","code":"impute.E(x)"},{"path":"https://hohoweiya.xyz/MTWAS/reference/impute.E.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Impute the list of expression matrix `E` — impute.E","text":"x twas data list","code":""},{"path":"https://hohoweiya.xyz/MTWAS/reference/impute.E.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Impute the list of expression matrix `E` — impute.E","text":"imputed twas data list imputation MSE error","code":""},{"path":"https://hohoweiya.xyz/MTWAS/reference/run_mtwas_easy.html","id":null,"dir":"Reference","previous_headings":"","what":"Run association test with downloaded trained data — run_mtwas_easy","title":"Run association test with downloaded trained data — run_mtwas_easy","text":"Run association test downloaded trained data","code":""},{"path":"https://hohoweiya.xyz/MTWAS/reference/run_mtwas_easy.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run association test with downloaded trained data — run_mtwas_easy","text":"","code":"run_mtwas_easy(stats, twas_bim, twas_eqtl)"},{"path":"https://hohoweiya.xyz/MTWAS/reference/run_mtwas_easy.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run association test with downloaded trained data — run_mtwas_easy","text":"stats summary statistics phenotype. can filename read data.frame, include columns rsid, a1, a2, chr, z twas_bim pre-downloaded file twas_eqtl pre-downloaded file","code":""},{"path":"https://hohoweiya.xyz/MTWAS/reference/run_mtwas_easy.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run association test with downloaded trained data — run_mtwas_easy","text":"mtwas summary statistics","code":""},{"path":"https://hohoweiya.xyz/MTWAS/reference/select.ct.eQTL.html","id":null,"dir":"Reference","previous_headings":"","what":"Detect the cross-tissue eQTLs — select.ct.eQTL","title":"Detect the cross-tissue eQTLs — select.ct.eQTL","text":"Detect cross-tissue eQTLs","code":""},{"path":"https://hohoweiya.xyz/MTWAS/reference/select.ct.eQTL.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Detect the cross-tissue eQTLs — select.ct.eQTL","text":"","code":"select.ct.eQTL(   x,   nne = -1,   gam = 1,   nF0 = 5,   verbose = T,   allow_empty = T,   ncores = 1L )"},{"path":"https://hohoweiya.xyz/MTWAS/reference/select.ct.eQTL.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Detect the cross-tissue eQTLs — select.ct.eQTL","text":"x TWAS data, list three elements: E list cell types, element matrix size n_sample x n_gene dat list three named elements. bed matrix size n_sample x n_snp bim data frame n_snp rows, row info snp  pos list genes, element vector containing SNP index  locate gene, corresponds row E.info.  can derived E.info dat. nne number genes considered. Default -1, means use genes. gam tuning parameter \\(\\gamma\\) EBIC criterion. Default 1. nF0 smallest number main effects. Default 5. verbose whether print running message. Default TRUE. allow_empty whether allow empty set. Default TRUE. ncores using parallel computing, number cores used. Default 1.","code":""},{"path":"https://hohoweiya.xyz/MTWAS/reference/select.ct.eQTL.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Detect the cross-tissue eQTLs — select.ct.eQTL","text":"list size n_gene, element shared eQTL gene.","code":""},{"path":"https://hohoweiya.xyz/MTWAS/reference/select.ts.eQTL.html","id":null,"dir":"Reference","previous_headings":"","what":"Select tissue-specific eQTLs — select.ts.eQTL","title":"Select tissue-specific eQTLs — select.ts.eQTL","text":"Select tissue-specific eQTLs","code":""},{"path":"https://hohoweiya.xyz/MTWAS/reference/select.ts.eQTL.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Select tissue-specific eQTLs — select.ts.eQTL","text":"","code":"select.ts.eQTL(x, ct.eQTL, id.tissue = -1, ncores = 1, ...)"},{"path":"https://hohoweiya.xyz/MTWAS/reference/select.ts.eQTL.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Select tissue-specific eQTLs — select.ts.eQTL","text":"x data ct.eQTL selected cross-tissue eQTLs select.ct.eQTL id.tissue index tissue (cell type) considered. Default -1, returns ts.eQTL tissues. ncores number cores. larger 1, use parallel computing. ... Arguments passed soda_model_imp_single gam tuning parameter \\(\\gamma\\) EBIC criteria. Default 1. scale whether scale expression genetic data regressing expression genetic data. Default FALSE. nF0 minimum size set","code":""},{"path":"https://hohoweiya.xyz/MTWAS/reference/soda_model_imp_share.html","id":null,"dir":"Reference","previous_headings":"","what":"Select cross-tissue via SODA — soda_model_imp_share","title":"Select cross-tissue via SODA — soda_model_imp_share","text":"Select cross-tissue via SODA","code":""},{"path":"https://hohoweiya.xyz/MTWAS/reference/soda_model_imp_share.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Select cross-tissue via SODA — soda_model_imp_share","text":"","code":"soda_model_imp_share(   j,   gam,   E,   dat,   pos,   nF0 = 5,   verbose = TRUE,   allow_empty = TRUE )"},{"path":"https://hohoweiya.xyz/MTWAS/reference/soda_model_imp_share.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Select cross-tissue via SODA — soda_model_imp_share","text":"j index gene gam TODO E list cell types, element matrix size n_sample x n_gene dat list three named elements. bed matrix size n_sample x n_snp bim data frame n_snp rows, row info snp pos list genes, element vector containing SNP index locate gene, corresponds row E.info. can derived E.info dat. nF0 TODO verbose whether print running messages allow_empty whether allow empty variable set","code":""},{"path":"https://hohoweiya.xyz/MTWAS/reference/soda_model_imp_single.html","id":null,"dir":"Reference","previous_headings":"","what":"Select tissue-specific via SODA — soda_model_imp_single","title":"Select tissue-specific via SODA — soda_model_imp_single","text":"Select tissue-specific via SODA","code":""},{"path":"https://hohoweiya.xyz/MTWAS/reference/soda_model_imp_single.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Select tissue-specific via SODA — soda_model_imp_single","text":"","code":"soda_model_imp_single(j, fix, E, dat, pos, gam = 1, scale = F, nF0 = 5)"},{"path":"https://hohoweiya.xyz/MTWAS/reference/soda_model_imp_single.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Select tissue-specific via SODA — soda_model_imp_single","text":"j index gene fix list set containing fixed effect gene E E just specific cell type, matrix instead list dat list three named elements. bed matrix size n_sample x n_snp bim data frame n_snp rows, row info snp pos list genes, element vector containing SNP index locate gene, corresponds row E.info. can derived E.info dat. gam tuning parameter \\(\\gamma\\) EBIC criteria. Default 1. scale whether scale expression genetic data regressing expression genetic data. Default FALSE. nF0 minimum size set","code":""},{"path":"https://hohoweiya.xyz/MTWAS/reference/summary_stats.html","id":null,"dir":"Reference","previous_headings":"","what":"Demo summary statistics — summary_stats","title":"Demo summary statistics — summary_stats","text":"Demo summary statistics","code":""},{"path":"https://hohoweiya.xyz/MTWAS/reference/summary_stats.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Demo summary statistics — summary_stats","text":"","code":"summary_stats"},{"path":"https://hohoweiya.xyz/MTWAS/reference/summary_stats.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Demo summary statistics — summary_stats","text":"## `summary_stats`","code":""},{"path":"https://hohoweiya.xyz/MTWAS/reference/twas.multi.trait.html","id":null,"dir":"Reference","previous_headings":"","what":"Run association test for multiple traits — twas.multi.trait","title":"Run association test for multiple traits — twas.multi.trait","text":"Run association test multiple traits","code":""},{"path":"https://hohoweiya.xyz/MTWAS/reference/twas.multi.trait.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run association test for multiple traits — twas.multi.trait","text":"","code":"twas.multi.trait(list.stats, x, list.ts.eQTL, ncores = 1)"},{"path":"https://hohoweiya.xyz/MTWAS/reference/twas.multi.trait.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run association test for multiple traits — twas.multi.trait","text":"list.stats list summary statistics, list files summary statistics x twas data list list.ts.eQTL list tissue-specific eQTL tissue ncores number cores parallel computing.","code":""},{"path":"https://hohoweiya.xyz/MTWAS/reference/twas.multi.trait.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run association test for multiple traits — twas.multi.trait","text":"list association tests traits","code":""},{"path":"https://hohoweiya.xyz/MTWAS/reference/twas.res.html","id":null,"dir":"Reference","previous_headings":"","what":"MTWAS main function — twas.res","title":"MTWAS main function — twas.res","text":"MTWAS main function","code":""},{"path":"https://hohoweiya.xyz/MTWAS/reference/twas.res.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"MTWAS main function — twas.res","text":"","code":"twas.res(stats, soda.all.imp, dat, pos)"},{"path":"https://hohoweiya.xyz/MTWAS/reference/twas.res.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"MTWAS main function — twas.res","text":"stats summary statistics soda..imp list selected important genes dat description pos xx","code":""},{"path":"https://hohoweiya.xyz/MTWAS/reference/twas.single.trait.html","id":null,"dir":"Reference","previous_headings":"","what":"An association test in a tissue-specific manner for a phenotype (trait). — twas.single.trait","title":"An association test in a tissue-specific manner for a phenotype (trait). — twas.single.trait","text":"association test tissue-specific manner phenotype (trait).","code":""},{"path":"https://hohoweiya.xyz/MTWAS/reference/twas.single.trait.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"An association test in a tissue-specific manner for a phenotype (trait). — twas.single.trait","text":"","code":"twas.single.trait(stats, x, list.ts.eQTL)"},{"path":"https://hohoweiya.xyz/MTWAS/reference/twas.single.trait.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"An association test in a tissue-specific manner for a phenotype (trait). — twas.single.trait","text":"stats summary statistics phenotype. can filename read data.frame. Suppose 5 columns colnames rsid, a1, a2, chr, z. x twas data list list.ts.eQTL list ts.eQTL, element corresponds tissue","code":""},{"path":"https://hohoweiya.xyz/MTWAS/reference/twas.single.trait.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"An association test in a tissue-specific manner for a phenotype (trait). — twas.single.trait","text":"z-statistics p-values. size n_gene x n_tissue.","code":""},{"path":"https://hohoweiya.xyz/MTWAS/reference/twas_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Datasets\nDemo TWAS data of three genes and two tissues — twas_data","title":"Datasets\nDemo TWAS data of three genes and two tissues — twas_data","text":"Datasets Demo TWAS data three genes two tissues","code":""},{"path":"https://hohoweiya.xyz/MTWAS/reference/twas_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Datasets\nDemo TWAS data of three genes and two tissues — twas_data","text":"","code":"twas_data"},{"path":"https://hohoweiya.xyz/MTWAS/reference/twas_data.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Datasets\nDemo TWAS data of three genes and two tissues — twas_data","text":"## `twas_data`","code":""}]
